https://github.com/cornell-brg/pymtl3-net/blob/master/netsim/netsim.py